@model List<UspeshnyiTrader.Models.Entities.Trade>
@using UspeshnyiTrader.Models.Entities
@{
    ViewData["Title"] = "–ò—Å—Ç–æ—Ä–∏—è —Å–¥–µ–ª–æ–∫";
}

<div class="container">
    <div class="row mb-4">
        <div class="col-12">
            <h1>üìã –ò—Å—Ç–æ—Ä–∏—è —Å–¥–µ–ª–æ–∫</h1>
            <p class="text-muted">–í–∞—à–∞ –ø–æ–ª–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è –∏—Å—Ç–æ—Ä–∏—è</p>
        </div>
    </div>

    @if (Model != null && Model.Any())    {
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th>–î–∞—Ç–∞/–í—Ä–µ–º—è</th>
                            <th>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç</th>
                            <th>–¢–∏–ø</th>
                            <th>–°—É–º–º–∞</th>
                            <th>–¶–µ–Ω–∞ –≤—Ö–æ–¥–∞</th>
                            <th>–¶–µ–Ω–∞ –≤—ã—Ö–æ–¥–∞</th>
                            <th>–ü—Ä–∏–±—ã–ª—å</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                        </tr>
                        </thead>
                        <tbody>
                        @foreach (var trade in Model)
                        {
                            <tr>
                                <td>@trade.CreatedAt.ToString("dd.MM.yyyy HH:mm")</td>
                                <td><strong>@trade.Instrument?.Symbol</strong></td>
                                <td>
                                    @if (trade.Type == TradeType.Buy)
                                    {
                                        <span class="badge bg-success">BUY</span>
                                    }
                                    else
                                    {
                                        <span class="badge bg-danger">SELL</span>
                                    }
                                </td>
                                <td>$@trade.Amount.ToString("F2")</td>
                                <td>$@trade.EntryPrice.ToString("F4")</td>
                                <td>@(trade.ExitPrice?.ToString("F4") ?? "-")</td>
                                <td class="@(trade.Profit > 0 ? "text-success" : trade.Profit < 0 ? "text-danger" : "")">
                                    @if (trade.Profit.HasValue)
                                    {
                                        @(trade.Profit > 0 ? "+" : "")@($"${trade.Profit.Value.ToString("F2")}")
                                    }
                                    else
                                    {
                                        <text>-</text>
                                    }
                                </td>
                                <td>
                                    @switch (trade.Status)
                                    {
                                        case TradeStatus.Active:
                                            <span class="badge bg-warning">–ê–ö–¢–ò–í–ù–ê</span>
                                            break;
                                        case TradeStatus.Completed:
                                            <span class="badge @(trade.Profit > 0 ? "bg-success" : "bg-danger")">
                                                    @(trade.Profit > 0 ? "–í–´–ò–ì–†–´–®" : "–ü–†–û–ò–ì–†–´–®")
                                                </span>
                                            break;
                                        case TradeStatus.Cancelled:
                                            <span class="badge bg-secondary">–û–¢–ú–ï–ù–ï–ù–ê</span>
                                            break;
                                        default:
                                            <span class="badge bg-info">@trade.Status</span>
                                            break;
                                    }
                                </td>
                            </tr>
                        }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    }
    else
    {
        <div class="text-center py-5">
            <div class="mb-4">
                <i class="fas fa-history fa-4x text-muted"></i>
            </div>
            <h3 class="text-muted">–ò—Å—Ç–æ—Ä–∏—è —Å–¥–µ–ª–æ–∫ –ø—É—Å—Ç–∞</h3>
            <p class="text-muted mb-4">–í—ã –µ—â–µ –Ω–µ —Å–æ–≤–µ—Ä—à–∞–ª–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π</p>
            <a href="@Url.Action("Index", "Trading")" class="btn btn-primary btn-lg">
                <i class="fas fa-chart-line"></i> –ù–∞—á–∞—Ç—å —Ç–æ—Ä–≥–æ–≤–∞—Ç—å
            </a>
        </div>
    }
</div>